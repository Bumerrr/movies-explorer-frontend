{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\ASUS\\\\dev\\\\diplom\\\\movies-explorer-frontend\\\\src\\\\components\\\\Movies\\\\Movies.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from \"react\";\nimport Header from \"../Header/Header\";\nimport SearchForm from \"../../components/SearchForm/SearchForm\";\nimport MoviesCardList from \"../../components/MoviesCardList/MoviesCardList\";\nimport Footer from \"../../components/Footer/Footer\";\nimport { SHORT_MAX_LENGTH } from \"../../utils/constants\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst Movies = _ref => {\n  _s();\n  let {\n    onCreateMovie,\n    onDeleteMovie,\n    externalMovies,\n    setExternalMovies,\n    myMovies,\n    setMyMovies,\n    getExternalMovies,\n    getMyMovies\n  } = _ref;\n  const [search, _setSearch] = useState(localStorage.getItem(\"externalMoviesSearch\") || \"\");\n  const [toggle, _setToggle] = useState(localStorage.getItem(\"externalMoviesToggle\") === \"true\" || false);\n  const [filteredMovies, setFilteredMovies] = useState([]);\n  const [busy, setBusy] = useState(false);\n  const setSearch = text => {\n    localStorage.setItem(\"externalMoviesSearch\", text);\n    _setSearch(text);\n  };\n  const setToggle = () => {\n    _setToggle(b => {\n      localStorage.setItem(\"externalMoviesToggle\", !b);\n      return !b;\n    });\n  };\n\n  // поиск и фильтрация фильмов\n  useEffect(() => {\n    if (search !== \"\") {\n      if (myMovies && externalMovies) {\n        const tmp = externalMovies.filter(item => {\n          return item.nameRU.toLowerCase().includes(search.toLowerCase()) && (toggle ? item.duration <= SHORT_MAX_LENGTH : true);\n        });\n        setFilteredMovies(tmp.map(item => {\n          const filtered = myMovies.filter(m => m.movieId === item.movieId);\n          const id = filtered.length > 0 ? filtered[0]._id : false;\n          const liked = id ? {\n            isLiked: true,\n            _id: id\n          } : {\n            isLiked: false\n          };\n          return {\n            ...item,\n            ...liked\n          };\n        }));\n      } else {\n        setBusy(true);\n        Promise.all([getExternalMovies(), getMyMovies()]).then(res => {\n          setExternalMovies(res[0]);\n          setMyMovies(res[1]);\n        });\n      }\n    } else {\n      setFilteredMovies([]);\n    }\n  }, [search, toggle, externalMovies, myMovies, setExternalMovies, setMyMovies, getExternalMovies, getMyMovies]);\n  useEffect(() => {\n    setBusy(false);\n  }, [filteredMovies]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Header, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(SearchForm, {\n      text: search,\n      setText: setSearch,\n      toggle: toggle,\n      setToggle: setToggle,\n      busy: busy\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(MoviesCardList, {\n      movies: filteredMovies,\n      busy: busy,\n      onLikeMovie: onCreateMovie,\n      onUnlikeMovie: onDeleteMovie\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Footer, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n};\n_s(Movies, \"MI6Ma9juOv2YOSXAbHF1Ly4bsU8=\");\n_c = Movies;\nexport default Movies;\nvar _c;\n$RefreshReg$(_c, \"Movies\");","map":{"version":3,"names":["React","useState","useEffect","Header","SearchForm","MoviesCardList","Footer","SHORT_MAX_LENGTH","jsxDEV","_jsxDEV","Fragment","_Fragment","Movies","_ref","_s","onCreateMovie","onDeleteMovie","externalMovies","setExternalMovies","myMovies","setMyMovies","getExternalMovies","getMyMovies","search","_setSearch","localStorage","getItem","toggle","_setToggle","filteredMovies","setFilteredMovies","busy","setBusy","setSearch","text","setItem","setToggle","b","tmp","filter","item","nameRU","toLowerCase","includes","duration","map","filtered","m","movieId","id","length","_id","liked","isLiked","Promise","all","then","res","children","fileName","_jsxFileName","lineNumber","columnNumber","setText","movies","onLikeMovie","onUnlikeMovie","_c","$RefreshReg$"],"sources":["C:/Users/ASUS/dev/diplom/movies-explorer-frontend/src/components/Movies/Movies.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport Header from \"../Header/Header\";\r\nimport SearchForm from \"../../components/SearchForm/SearchForm\";\r\nimport MoviesCardList from \"../../components/MoviesCardList/MoviesCardList\";\r\nimport Footer from \"../../components/Footer/Footer\";\r\nimport { SHORT_MAX_LENGTH } from \"../../utils/constants\";\r\n\r\nconst Movies = ({\r\n  onCreateMovie,\r\n  onDeleteMovie,\r\n  externalMovies,\r\n  setExternalMovies,\r\n  myMovies,\r\n  setMyMovies,\r\n  getExternalMovies,\r\n  getMyMovies,\r\n}) => {\r\n  const [search, _setSearch] = useState(\r\n    localStorage.getItem(\"externalMoviesSearch\") || \"\"\r\n  );\r\n  const [toggle, _setToggle] = useState(\r\n    localStorage.getItem(\"externalMoviesToggle\") === \"true\" || false\r\n  );\r\n  const [filteredMovies, setFilteredMovies] = useState([]);\r\n  const [busy, setBusy] = useState(false);\r\n\r\n  const setSearch = (text) => {\r\n    localStorage.setItem(\"externalMoviesSearch\", text);\r\n    _setSearch(text);\r\n  };\r\n\r\n  const setToggle = () => {\r\n    _setToggle((b) => {\r\n      localStorage.setItem(\"externalMoviesToggle\", !b);\r\n      return !b;\r\n    });\r\n  };\r\n\r\n  // поиск и фильтрация фильмов\r\n  useEffect(() => {\r\n    if (search !== \"\") {\r\n      if (myMovies && externalMovies) {\r\n        const tmp = externalMovies.filter((item) => {\r\n          return (\r\n            item.nameRU.toLowerCase().includes(search.toLowerCase()) &&\r\n            (toggle ? item.duration <= SHORT_MAX_LENGTH : true)\r\n          );\r\n        });\r\n        setFilteredMovies(\r\n          tmp.map((item) => {\r\n            const filtered = myMovies.filter((m) => m.movieId === item.movieId);\r\n            const id = filtered.length > 0 ? filtered[0]._id : false;\r\n            const liked = id ? { isLiked: true, _id: id } : { isLiked: false };\r\n\r\n            return { ...item, ...liked };\r\n          })\r\n        );\r\n      } else {\r\n        setBusy(true);\r\n\r\n        Promise.all([getExternalMovies(), getMyMovies()]).then((res) => {\r\n          setExternalMovies(res[0]);\r\n          setMyMovies(res[1]);\r\n        });\r\n      }\r\n    } else {\r\n     setFilteredMovies([]);\r\n    }\r\n  }, [\r\n    search,\r\n    toggle,\r\n    externalMovies,\r\n    myMovies,\r\n    setExternalMovies,\r\n    setMyMovies,\r\n    getExternalMovies,\r\n    getMyMovies,\r\n  ]);\r\n\r\n  useEffect(() => {\r\n    setBusy(false);\r\n  }, [filteredMovies]);\r\n\r\n  return (\r\n    <>\r\n      <Header />\r\n      <SearchForm\r\n        text={search}\r\n        setText={setSearch}\r\n        toggle={toggle}\r\n        setToggle={setToggle}\r\n        busy={busy}\r\n      />\r\n      <MoviesCardList\r\n        movies={filteredMovies}\r\n        busy={busy}\r\n        onLikeMovie={onCreateMovie}\r\n        onUnlikeMovie={onDeleteMovie}\r\n      />\r\n      <Footer />\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Movies;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}